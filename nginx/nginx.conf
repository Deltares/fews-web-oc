worker_processes 4;
 
events { worker_connections 1024; }
 
http {
    server {
        listen 8080;
        root  /usr/share/nginx/html;
        include /etc/nginx/mime.types;
 
        expires 1d;
        add_header X-Content-Type-Options nosniff;
        add_header X-Frame-Options "SAMEORIGIN";
        add_header X-XSS-Protection "1; mode=block";
        add_header Referrer-Policy "no-referrer-when-downgrade";
        add_header Permissions-Policy "fullscreen=(self)";
        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header Content-Security-Policy "default-src 'self';";
 
        gzip on;
        gzip_types
            application/atom+xml
            application/geo+json
            application/javascript
            application/x-javascript
            application/json
            application/ld+json
            application/manifest+json
            application/rdf+xml
            application/rss+xml
            application/xhtml+xml
            application/xml
            font/eot
            font/otf
            font/ttf
            image/svg+xml
            text/css
            text/javascript
            text/plain
            text/xml;

        location /iwp {
            add_header Cache-Control "public";
            add_header Content-Security-Policy "img-src 'self' data:; frame-ancestors 'self' *.rws.nl;";
            try_files $uri /iwp/index.html =404;
        }

        # location /iwp/FewsWebServices/ {
        #     proxy_http_version    1.1;
        #     proxy_set_header      Host $host;
        #     proxy_set_header      X-Real-IP $remote_addr;
        #     proxy_set_header      X-Forwarded-For $proxy_add_x_forwarded_for;
        #     proxy_pass            https://rwsos-dataservices-ont.avi.deltares.nl/iwp/test/FewsWebServices/;
        #     proxy_set_header      Upgrade $http_upgrade;
        # }

        location /iwp/index.html {
            add_header Cache-Control 'no-store';
        }

    }
}
